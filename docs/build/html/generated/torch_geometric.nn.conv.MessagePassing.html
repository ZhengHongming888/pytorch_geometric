<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>torch_geometric.nn.conv.MessagePassing &mdash; pytorch_geometric  documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/mytheme.css" type="text/css" />
    <link rel="shortcut icon" href="https://raw.githubusercontent.com/pyg-team/pyg_sphinx_theme/master/pyg_sphinx_theme/static/img/favicon.png"/>
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/js/on_pyg_load.js"></script>
        <script src="../_static/js/version_alert.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
        <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="torch_geometric.nn.conv.SimpleConv" href="torch_geometric.nn.conv.SimpleConv.html" />
    <link rel="prev" title="torch_geometric.nn" href="../modules/nn.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html">
            
              <img src="https://raw.githubusercontent.com/pyg-team/pyg_sphinx_theme/master/pyg_sphinx_theme/static/img/pyg_logo.png" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                2.4.0
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Install PyG</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../install/installation.html">Installation</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Get Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../get_started/introduction.html">Introduction by Example</a></li>
<li class="toctree-l1"><a class="reference internal" href="../get_started/colabs.html">Colab Notebooks and Video Tutorials</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Tutorials</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../tutorial/gnn_design.html">Design of Graph Neural Networks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorial/dataset.html">Working with Graph Datasets</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorial/application.html">Use-Cases &amp; Applications</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorial/multi_gpu.html">Multi-GPU Training</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Advanced Concepts</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../advanced/batching.html">Advanced Mini-Batching</a></li>
<li class="toctree-l1"><a class="reference internal" href="../advanced/sparse_tensor.html">Memory-Efficient Aggregations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../advanced/hgam.html">Hierarchical Neighborhood Sampling</a></li>
<li class="toctree-l1"><a class="reference internal" href="../advanced/compile.html">Compiled Graph Neural Networks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../advanced/jit.html">TorchScript Support</a></li>
<li class="toctree-l1"><a class="reference internal" href="../advanced/remote.html">Scaling Up GNNs via Remote Backends</a></li>
<li class="toctree-l1"><a class="reference internal" href="../advanced/graphgym.html">Managing Experiments with GraphGym</a></li>
<li class="toctree-l1"><a class="reference internal" href="../advanced/cpu_affinity.html">CPU Affinity for PyG Workloads</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Package Reference</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../modules/root.html">torch_geometric</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../modules/nn.html">torch_geometric.nn</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="../modules/nn.html#convolutional-layers">Convolutional Layers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../modules/nn.html#aggregation-operators">Aggregation Operators</a></li>
<li class="toctree-l2"><a class="reference internal" href="../modules/nn.html#normalization-layers">Normalization Layers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../modules/nn.html#pooling-layers">Pooling Layers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../modules/nn.html#unpooling-layers">Unpooling Layers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../modules/nn.html#models">Models</a></li>
<li class="toctree-l2"><a class="reference internal" href="../modules/nn.html#kge-models">KGE Models</a></li>
<li class="toctree-l2"><a class="reference internal" href="../modules/nn.html#module-torch_geometric.nn.encoding">Encodings</a></li>
<li class="toctree-l2"><a class="reference internal" href="../modules/nn.html#functional">Functional</a></li>
<li class="toctree-l2"><a class="reference internal" href="../modules/nn.html#dense-convolutional-layers">Dense Convolutional Layers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../modules/nn.html#dense-pooling-layers">Dense Pooling Layers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../modules/nn.html#model-transformations">Model Transformations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../modules/nn.html#module-torch_geometric.nn.data_parallel">DataParallel Layers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../modules/nn.html#module-torch_geometric.nn.model_hub">Model Hub</a></li>
<li class="toctree-l2"><a class="reference internal" href="../modules/nn.html#module-torch_geometric.nn.summary">Model Summary</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../modules/data.html">torch_geometric.data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../modules/loader.html">torch_geometric.loader</a></li>
<li class="toctree-l1"><a class="reference internal" href="../modules/sampler.html">torch_geometric.sampler</a></li>
<li class="toctree-l1"><a class="reference internal" href="../modules/datasets.html">torch_geometric.datasets</a></li>
<li class="toctree-l1"><a class="reference internal" href="../modules/transforms.html">torch_geometric.transforms</a></li>
<li class="toctree-l1"><a class="reference internal" href="../modules/utils.html">torch_geometric.utils</a></li>
<li class="toctree-l1"><a class="reference internal" href="../modules/explain.html">torch_geometric.explain</a></li>
<li class="toctree-l1"><a class="reference internal" href="../modules/contrib.html">torch_geometric.contrib</a></li>
<li class="toctree-l1"><a class="reference internal" href="../modules/graphgym.html">torch_geometric.graphgym</a></li>
<li class="toctree-l1"><a class="reference internal" href="../modules/profile.html">torch_geometric.profile</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Cheatsheets</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../cheatsheet/gnn_cheatsheet.html">GNN Cheatsheet</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cheatsheet/data_cheatsheet.html">Dataset Cheatsheet</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">External Resources</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../external/resources.html">External Resources</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">pytorch_geometric</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../modules/nn.html">torch_geometric.nn</a></li>
      <li class="breadcrumb-item active">torch_geometric.nn.conv.MessagePassing</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/generated/torch_geometric.nn.conv.MessagePassing.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="torch-geometric-nn-conv-messagepassing">
<h1>torch_geometric.nn.conv.MessagePassing<a class="headerlink" href="#torch-geometric-nn-conv-messagepassing" title="Permalink to this heading"></a></h1>
<dl class="py class">
<dt class="sig sig-object py" id="torch_geometric.nn.conv.MessagePassing">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">MessagePassing</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">aggr</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.12)"><span class="pre">Optional</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.12)"><span class="pre">Union</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.12)"><span class="pre">List</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="torch_geometric.nn.aggr.Aggregation.html#torch_geometric.nn.aggr.Aggregation" title="torch_geometric.nn.aggr.base.Aggregation"><span class="pre">Aggregation</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'add'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">aggr_kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.12)"><span class="pre">Optional</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Dict" title="(in Python v3.12)"><span class="pre">Dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.12)"><span class="pre">Any</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flow</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'source_to_target'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">node_dim</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">-2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">decomposed_layers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torch_geometric/nn/conv/message_passing.html#MessagePassing"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torch_geometric.nn.conv.MessagePassing" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference external" href="https://pytorch.org/docs/master/generated/torch.nn.Module.html#torch.nn.Module" title="(in PyTorch vmaster (2.1.0a0+gitbe0b12e ))"><code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></a></p>
<p>Base class for creating message passing layers.</p>
<p>Message passing layers follow the form</p>
<div class="math notranslate nohighlight">
\[\mathbf{x}_i^{\prime} = \gamma_{\mathbf{\Theta}} \left( \mathbf{x}_i,
\bigoplus_{j \in \mathcal{N}(i)} \, \phi_{\mathbf{\Theta}}
\left(\mathbf{x}_i, \mathbf{x}_j,\mathbf{e}_{j,i}\right) \right),\]</div>
<p>where <span class="math notranslate nohighlight">\(\bigoplus\)</span> denotes a differentiable, permutation invariant
function, <em>e.g.</em>, sum, mean, min, max or mul, and
<span class="math notranslate nohighlight">\(\gamma_{\mathbf{\Theta}}\)</span> and <span class="math notranslate nohighlight">\(\phi_{\mathbf{\Theta}}\)</span> denote
differentiable functions such as MLPs.
See <a class="reference external" href="https://pytorch-geometric.readthedocs.io/en/latest/tutorial/create_gnn.html">here</a> for the accompanying tutorial.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>aggr</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a><em> or </em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a><em>] or </em><a class="reference internal" href="torch_geometric.nn.aggr.Aggregation.html#torch_geometric.nn.aggr.Aggregation" title="torch_geometric.nn.aggr.Aggregation"><em>Aggregation</em></a><em>, </em><em>optional</em>) – The aggregation scheme
to use, <em>e.g.</em>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">&quot;add&quot;</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">&quot;sum&quot;</span></code> <code class="xref py py-obj docutils literal notranslate"><span class="pre">&quot;mean&quot;</span></code>,
<code class="xref py py-obj docutils literal notranslate"><span class="pre">&quot;min&quot;</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">&quot;max&quot;</span></code> or <code class="xref py py-obj docutils literal notranslate"><span class="pre">&quot;mul&quot;</span></code>.
In addition, can be any
<a class="reference internal" href="torch_geometric.nn.aggr.Aggregation.html#torch_geometric.nn.aggr.Aggregation" title="torch_geometric.nn.aggr.Aggregation"><code class="xref py py-class docutils literal notranslate"><span class="pre">Aggregation</span></code></a> module (or any string
that automatically resolves to it).
If given as a list, will make use of multiple aggregations in which
different outputs will get concatenated in the last dimension.
If set to <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>, the <a class="reference internal" href="#torch_geometric.nn.conv.MessagePassing" title="torch_geometric.nn.conv.MessagePassing"><code class="xref py py-class docutils literal notranslate"><span class="pre">MessagePassing</span></code></a> instantiation is
expected to implement its own aggregation logic via
<a class="reference internal" href="#torch_geometric.nn.conv.MessagePassing.aggregate" title="torch_geometric.nn.conv.MessagePassing.aggregate"><code class="xref py py-meth docutils literal notranslate"><span class="pre">aggregate()</span></code></a>. (default: <code class="xref py py-obj docutils literal notranslate"><span class="pre">&quot;add&quot;</span></code>)</p></li>
<li><p><strong>aggr_kwargs</strong> (<em>Dict</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a><em>, </em><em>Any</em><em>]</em><em>, </em><em>optional</em>) – Arguments passed to the
respective aggregation function in case it gets automatically
resolved. (default: <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>)</p></li>
<li><p><strong>flow</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a><em>, </em><em>optional</em>) – The flow direction of message passing
(<code class="xref py py-obj docutils literal notranslate"><span class="pre">&quot;source_to_target&quot;</span></code> or <code class="xref py py-obj docutils literal notranslate"><span class="pre">&quot;target_to_source&quot;</span></code>).
(default: <code class="xref py py-obj docutils literal notranslate"><span class="pre">&quot;source_to_target&quot;</span></code>)</p></li>
<li><p><strong>node_dim</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a><em>, </em><em>optional</em>) – The axis along which to propagate.
(default: <code class="xref py py-obj docutils literal notranslate"><span class="pre">-2</span></code>)</p></li>
<li><p><strong>decomposed_layers</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a><em>, </em><em>optional</em>) – The number of feature decomposition
layers, as introduced in the <a class="reference external" href="https://arxiv.org/abs/2104.03058">“Optimizing Memory Efficiency of
Graph Neural Networks on Edge Computing Platforms”</a> paper.
Feature decomposition reduces the peak memory usage by slicing
the feature dimensions into separated feature decomposition layers
during GNN aggregation.
This method can accelerate GNN execution on CPU-based platforms
(<em>e.g.</em>, 2-3x speedup on the
<a class="reference internal" href="torch_geometric.datasets.Reddit.html#torch_geometric.datasets.Reddit" title="torch_geometric.datasets.Reddit"><code class="xref py py-class docutils literal notranslate"><span class="pre">Reddit</span></code></a> dataset) for common GNN
models such as <a class="reference internal" href="torch_geometric.nn.models.GCN.html#torch_geometric.nn.models.GCN" title="torch_geometric.nn.models.GCN"><code class="xref py py-class docutils literal notranslate"><span class="pre">GCN</span></code></a>,
<a class="reference internal" href="torch_geometric.nn.models.GraphSAGE.html#torch_geometric.nn.models.GraphSAGE" title="torch_geometric.nn.models.GraphSAGE"><code class="xref py py-class docutils literal notranslate"><span class="pre">GraphSAGE</span></code></a>,
<a class="reference internal" href="torch_geometric.nn.models.GIN.html#torch_geometric.nn.models.GIN" title="torch_geometric.nn.models.GIN"><code class="xref py py-class docutils literal notranslate"><span class="pre">GIN</span></code></a>, etc.
However, this method is not applicable to all GNN operators
available, in particular for operators in which message computation
can not easily be decomposed, <em>e.g.</em> in attention-based GNNs.
The selection of the optimal value of <code class="xref py py-obj docutils literal notranslate"><span class="pre">decomposed_layers</span></code>
depends both on the specific graph dataset and available hardware
resources.
A value of <code class="xref py py-obj docutils literal notranslate"><span class="pre">2</span></code> is suitable in most cases.
Although the peak memory usage is directly associated with the
granularity of feature decomposition, the same is not necessarily
true for execution speedups. (default: <code class="xref py py-obj docutils literal notranslate"><span class="pre">1</span></code>)</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="torch_geometric.nn.conv.MessagePassing.reset_parameters">
<span class="sig-name descname"><span class="pre">reset_parameters</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torch_geometric/nn/conv/message_passing.html#MessagePassing.reset_parameters"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torch_geometric.nn.conv.MessagePassing.reset_parameters" title="Permalink to this definition"></a></dt>
<dd><p>Resets all learnable parameters of the module.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="torch_geometric.nn.conv.MessagePassing.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.12)"><span class="pre">Any</span></a></span></span><a class="reference internal" href="../_modules/torch_geometric/nn/conv/message_passing.html#MessagePassing.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torch_geometric.nn.conv.MessagePassing.forward" title="Permalink to this definition"></a></dt>
<dd><p>Runs the forward pass of the module.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="torch_geometric.nn.conv.MessagePassing.propagate">
<span class="sig-name descname"><span class="pre">propagate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">edge_index</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.12)"><span class="pre">Union</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://pytorch.org/docs/master/tensors.html#torch.Tensor" title="(in PyTorch vmaster (2.1.0a0+gitbe0b12e ))"><span class="pre">Tensor</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">SparseTensor</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.12)"><span class="pre">Optional</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.12)"><span class="pre">Tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torch_geometric/nn/conv/message_passing.html#MessagePassing.propagate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torch_geometric.nn.conv.MessagePassing.propagate" title="Permalink to this definition"></a></dt>
<dd><p>The initial call to start propagating messages.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>edge_index</strong> (<a class="reference external" href="https://pytorch.org/docs/master/tensors.html#torch.Tensor" title="(in PyTorch vmaster (2.1.0a0+gitbe0b12e ))"><em>torch.Tensor</em></a><em> or </em><em>SparseTensor</em>) – A <a class="reference external" href="https://pytorch.org/docs/master/tensors.html#torch.Tensor" title="(in PyTorch vmaster (2.1.0a0+gitbe0b12e ))"><code class="xref py py-class docutils literal notranslate"><span class="pre">torch.Tensor</span></code></a>,
a <code class="xref py py-class docutils literal notranslate"><span class="pre">torch_sparse.SparseTensor</span></code> or a
<code class="xref py py-class docutils literal notranslate"><span class="pre">torch.sparse.Tensor</span></code> that defines the underlying
graph connectivity/message passing flow.
<code class="xref py py-obj docutils literal notranslate"><span class="pre">edge_index</span></code> holds the indices of a general (sparse)
assignment matrix of shape <code class="xref py py-obj docutils literal notranslate"><span class="pre">[N,</span> <span class="pre">M]</span></code>.
If <code class="xref py py-obj docutils literal notranslate"><span class="pre">edge_index</span></code> is a <a class="reference external" href="https://pytorch.org/docs/master/tensors.html#torch.Tensor" title="(in PyTorch vmaster (2.1.0a0+gitbe0b12e ))"><code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.Tensor</span></code></a>, its <code class="xref py py-obj docutils literal notranslate"><span class="pre">dtype</span></code>
should be <code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.long</span></code> and its shape needs to be defined
as <code class="xref py py-obj docutils literal notranslate"><span class="pre">[2,</span> <span class="pre">num_messages]</span></code> where messages from nodes in
<code class="xref py py-obj docutils literal notranslate"><span class="pre">edge_index[0]</span></code> are sent to nodes in <code class="xref py py-obj docutils literal notranslate"><span class="pre">edge_index[1]</span></code>
(in case <code class="xref py py-obj docutils literal notranslate"><span class="pre">flow=&quot;source_to_target&quot;</span></code>).
If <code class="xref py py-obj docutils literal notranslate"><span class="pre">edge_index</span></code> is a <code class="xref py py-class docutils literal notranslate"><span class="pre">torch_sparse.SparseTensor</span></code> or
a <code class="xref py py-class docutils literal notranslate"><span class="pre">torch.sparse.Tensor</span></code>, its sparse indices
<code class="xref py py-obj docutils literal notranslate"><span class="pre">(row,</span> <span class="pre">col)</span></code> should relate to <code class="xref py py-obj docutils literal notranslate"><span class="pre">row</span> <span class="pre">=</span> <span class="pre">edge_index[1]</span></code>
and <code class="xref py py-obj docutils literal notranslate"><span class="pre">col</span> <span class="pre">=</span> <span class="pre">edge_index[0]</span></code>.
The major difference between both formats is that we need to
input the <em>transposed</em> sparse adjacency matrix into
<a class="reference internal" href="#torch_geometric.nn.conv.MessagePassing.propagate" title="torch_geometric.nn.conv.MessagePassing.propagate"><code class="xref py py-meth docutils literal notranslate"><span class="pre">propagate()</span></code></a>.</p></li>
<li><p><strong>size</strong> (<em>(</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a><em>)</em><em>, </em><em>optional</em>) – The size <code class="xref py py-obj docutils literal notranslate"><span class="pre">(N,</span> <span class="pre">M)</span></code> of the
assignment matrix in case <code class="xref py py-obj docutils literal notranslate"><span class="pre">edge_index</span></code> is a
<a class="reference external" href="https://pytorch.org/docs/master/tensors.html#torch.Tensor" title="(in PyTorch vmaster (2.1.0a0+gitbe0b12e ))"><code class="xref py py-class docutils literal notranslate"><span class="pre">torch.Tensor</span></code></a>.
If set to <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>, the size will be automatically inferred
and assumed to be quadratic.
This argument is ignored in case <code class="xref py py-obj docutils literal notranslate"><span class="pre">edge_index</span></code> is a
<code class="xref py py-class docutils literal notranslate"><span class="pre">torch_sparse.SparseTensor</span></code> or
a <code class="xref py py-class docutils literal notranslate"><span class="pre">torch.sparse.Tensor</span></code>. (default: <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>)</p></li>
<li><p><strong>**kwargs</strong> – Any additional data which is needed to construct and
aggregate messages, and to update node embeddings.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="torch_geometric.nn.conv.MessagePassing.edge_updater">
<span class="sig-name descname"><span class="pre">edge_updater</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">edge_index</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.12)"><span class="pre">Union</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://pytorch.org/docs/master/tensors.html#torch.Tensor" title="(in PyTorch vmaster (2.1.0a0+gitbe0b12e ))"><span class="pre">Tensor</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">SparseTensor</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torch_geometric/nn/conv/message_passing.html#MessagePassing.edge_updater"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torch_geometric.nn.conv.MessagePassing.edge_updater" title="Permalink to this definition"></a></dt>
<dd><p>The initial call to compute or update features for each edge in the
graph.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>edge_index</strong> (<a class="reference external" href="https://pytorch.org/docs/master/tensors.html#torch.Tensor" title="(in PyTorch vmaster (2.1.0a0+gitbe0b12e ))"><em>torch.Tensor</em></a><em> or </em><em>SparseTensor</em>) – A <a class="reference external" href="https://pytorch.org/docs/master/tensors.html#torch.Tensor" title="(in PyTorch vmaster (2.1.0a0+gitbe0b12e ))"><code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.Tensor</span></code></a>, a
<code class="xref py py-class docutils literal notranslate"><span class="pre">torch_sparse.SparseTensor</span></code> or a
<code class="xref py py-class docutils literal notranslate"><span class="pre">torch.sparse.Tensor</span></code> that defines the underlying graph
connectivity/message passing flow.
See <a class="reference internal" href="#torch_geometric.nn.conv.MessagePassing.propagate" title="torch_geometric.nn.conv.MessagePassing.propagate"><code class="xref py py-meth docutils literal notranslate"><span class="pre">propagate()</span></code></a> for more information.</p></li>
<li><p><strong>**kwargs</strong> – Any additional data which is needed to compute or update
features for each edge in the graph.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="torch_geometric.nn.conv.MessagePassing.message">
<span class="sig-name descname"><span class="pre">message</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x_j</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://pytorch.org/docs/master/tensors.html#torch.Tensor" title="(in PyTorch vmaster (2.1.0a0+gitbe0b12e ))"><span class="pre">Tensor</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://pytorch.org/docs/master/tensors.html#torch.Tensor" title="(in PyTorch vmaster (2.1.0a0+gitbe0b12e ))"><span class="pre">Tensor</span></a></span></span><a class="reference internal" href="../_modules/torch_geometric/nn/conv/message_passing.html#MessagePassing.message"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torch_geometric.nn.conv.MessagePassing.message" title="Permalink to this definition"></a></dt>
<dd><p>Constructs messages from node <span class="math notranslate nohighlight">\(j\)</span> to node <span class="math notranslate nohighlight">\(i\)</span>
in analogy to <span class="math notranslate nohighlight">\(\phi_{\mathbf{\Theta}}\)</span> for each edge in
<code class="xref py py-obj docutils literal notranslate"><span class="pre">edge_index</span></code>.
This function can take any argument as input which was initially
passed to <a class="reference internal" href="#torch_geometric.nn.conv.MessagePassing.propagate" title="torch_geometric.nn.conv.MessagePassing.propagate"><code class="xref py py-meth docutils literal notranslate"><span class="pre">propagate()</span></code></a>.
Furthermore, tensors passed to <a class="reference internal" href="#torch_geometric.nn.conv.MessagePassing.propagate" title="torch_geometric.nn.conv.MessagePassing.propagate"><code class="xref py py-meth docutils literal notranslate"><span class="pre">propagate()</span></code></a> can be mapped to the
respective nodes <span class="math notranslate nohighlight">\(i\)</span> and <span class="math notranslate nohighlight">\(j\)</span> by appending <code class="xref py py-obj docutils literal notranslate"><span class="pre">_i</span></code> or
<code class="xref py py-obj docutils literal notranslate"><span class="pre">_j</span></code> to the variable name, <em>.e.g.</em> <code class="xref py py-obj docutils literal notranslate"><span class="pre">x_i</span></code> and <code class="xref py py-obj docutils literal notranslate"><span class="pre">x_j</span></code>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="torch_geometric.nn.conv.MessagePassing.aggregate">
<span class="sig-name descname"><span class="pre">aggregate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inputs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://pytorch.org/docs/master/tensors.html#torch.Tensor" title="(in PyTorch vmaster (2.1.0a0+gitbe0b12e ))"><span class="pre">Tensor</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">index</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://pytorch.org/docs/master/tensors.html#torch.Tensor" title="(in PyTorch vmaster (2.1.0a0+gitbe0b12e ))"><span class="pre">Tensor</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">ptr</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.12)"><span class="pre">Optional</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://pytorch.org/docs/master/tensors.html#torch.Tensor" title="(in PyTorch vmaster (2.1.0a0+gitbe0b12e ))"><span class="pre">Tensor</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dim_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.12)"><span class="pre">Optional</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://pytorch.org/docs/master/tensors.html#torch.Tensor" title="(in PyTorch vmaster (2.1.0a0+gitbe0b12e ))"><span class="pre">Tensor</span></a></span></span><a class="reference internal" href="../_modules/torch_geometric/nn/conv/message_passing.html#MessagePassing.aggregate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torch_geometric.nn.conv.MessagePassing.aggregate" title="Permalink to this definition"></a></dt>
<dd><p>Aggregates messages from neighbors as
<span class="math notranslate nohighlight">\(\bigoplus_{j \in \mathcal{N}(i)}\)</span>.</p>
<p>Takes in the output of message computation as first argument and any
argument which was initially passed to <a class="reference internal" href="#torch_geometric.nn.conv.MessagePassing.propagate" title="torch_geometric.nn.conv.MessagePassing.propagate"><code class="xref py py-meth docutils literal notranslate"><span class="pre">propagate()</span></code></a>.</p>
<p>By default, this function will delegate its call to the underlying
<a class="reference internal" href="torch_geometric.nn.aggr.Aggregation.html#torch_geometric.nn.aggr.Aggregation" title="torch_geometric.nn.aggr.Aggregation"><code class="xref py py-class docutils literal notranslate"><span class="pre">Aggregation</span></code></a> module to reduce messages
as specified in <code class="xref py py-meth docutils literal notranslate"><span class="pre">__init__()</span></code> by the <code class="xref py py-obj docutils literal notranslate"><span class="pre">aggr</span></code> argument.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="torch_geometric.nn.conv.MessagePassing.message_and_aggregate">
<span class="sig-name descname"><span class="pre">message_and_aggregate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">adj_t</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.12)"><span class="pre">Union</span></a><span class="p"><span class="pre">[</span></span><span class="pre">SparseTensor</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://pytorch.org/docs/master/tensors.html#torch.Tensor" title="(in PyTorch vmaster (2.1.0a0+gitbe0b12e ))"><span class="pre">Tensor</span></a><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://pytorch.org/docs/master/tensors.html#torch.Tensor" title="(in PyTorch vmaster (2.1.0a0+gitbe0b12e ))"><span class="pre">Tensor</span></a></span></span><a class="reference internal" href="../_modules/torch_geometric/nn/conv/message_passing.html#MessagePassing.message_and_aggregate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torch_geometric.nn.conv.MessagePassing.message_and_aggregate" title="Permalink to this definition"></a></dt>
<dd><p>Fuses computations of <a class="reference internal" href="#torch_geometric.nn.conv.MessagePassing.message" title="torch_geometric.nn.conv.MessagePassing.message"><code class="xref py py-func docutils literal notranslate"><span class="pre">message()</span></code></a> and <a class="reference internal" href="#torch_geometric.nn.conv.MessagePassing.aggregate" title="torch_geometric.nn.conv.MessagePassing.aggregate"><code class="xref py py-func docutils literal notranslate"><span class="pre">aggregate()</span></code></a> into a
single function.
If applicable, this saves both time and memory since messages do not
explicitly need to be materialized.
This function will only gets called in case it is implemented and
propagation takes place based on a <code class="xref py py-obj docutils literal notranslate"><span class="pre">torch_sparse.SparseTensor</span></code>
or a <code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.sparse.Tensor</span></code>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="torch_geometric.nn.conv.MessagePassing.update">
<span class="sig-name descname"><span class="pre">update</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inputs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://pytorch.org/docs/master/tensors.html#torch.Tensor" title="(in PyTorch vmaster (2.1.0a0+gitbe0b12e ))"><span class="pre">Tensor</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://pytorch.org/docs/master/tensors.html#torch.Tensor" title="(in PyTorch vmaster (2.1.0a0+gitbe0b12e ))"><span class="pre">Tensor</span></a></span></span><a class="reference internal" href="../_modules/torch_geometric/nn/conv/message_passing.html#MessagePassing.update"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torch_geometric.nn.conv.MessagePassing.update" title="Permalink to this definition"></a></dt>
<dd><p>Updates node embeddings in analogy to
<span class="math notranslate nohighlight">\(\gamma_{\mathbf{\Theta}}\)</span> for each node
<span class="math notranslate nohighlight">\(i \in \mathcal{V}\)</span>.
Takes in the output of aggregation as first argument and any argument
which was initially passed to <a class="reference internal" href="#torch_geometric.nn.conv.MessagePassing.propagate" title="torch_geometric.nn.conv.MessagePassing.propagate"><code class="xref py py-meth docutils literal notranslate"><span class="pre">propagate()</span></code></a>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="torch_geometric.nn.conv.MessagePassing.edge_update">
<span class="sig-name descname"><span class="pre">edge_update</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://pytorch.org/docs/master/tensors.html#torch.Tensor" title="(in PyTorch vmaster (2.1.0a0+gitbe0b12e ))"><span class="pre">Tensor</span></a></span></span><a class="reference internal" href="../_modules/torch_geometric/nn/conv/message_passing.html#MessagePassing.edge_update"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torch_geometric.nn.conv.MessagePassing.edge_update" title="Permalink to this definition"></a></dt>
<dd><p>Computes or updates features for each edge in the graph.
This function can take any argument as input which was initially passed
to <a class="reference internal" href="#torch_geometric.nn.conv.MessagePassing.edge_updater" title="torch_geometric.nn.conv.MessagePassing.edge_updater"><code class="xref py py-meth docutils literal notranslate"><span class="pre">edge_updater()</span></code></a>.
Furthermore, tensors passed to <a class="reference internal" href="#torch_geometric.nn.conv.MessagePassing.edge_updater" title="torch_geometric.nn.conv.MessagePassing.edge_updater"><code class="xref py py-meth docutils literal notranslate"><span class="pre">edge_updater()</span></code></a> can be mapped to
the respective nodes <span class="math notranslate nohighlight">\(i\)</span> and <span class="math notranslate nohighlight">\(j\)</span> by appending <code class="xref py py-obj docutils literal notranslate"><span class="pre">_i</span></code> or
<code class="xref py py-obj docutils literal notranslate"><span class="pre">_j</span></code> to the variable name, <em>.e.g.</em> <code class="xref py py-obj docutils literal notranslate"><span class="pre">x_i</span></code> and <code class="xref py py-obj docutils literal notranslate"><span class="pre">x_j</span></code>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="torch_geometric.nn.conv.MessagePassing.register_propagate_forward_pre_hook">
<span class="sig-name descname"><span class="pre">register_propagate_forward_pre_hook</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hook</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.12)"><span class="pre">Callable</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">RemovableHandle</span></span></span><a class="reference internal" href="../_modules/torch_geometric/nn/conv/message_passing.html#MessagePassing.register_propagate_forward_pre_hook"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torch_geometric.nn.conv.MessagePassing.register_propagate_forward_pre_hook" title="Permalink to this definition"></a></dt>
<dd><p>Registers a forward pre-hook on the module.</p>
<p>The hook will be called every time before <a class="reference internal" href="#torch_geometric.nn.conv.MessagePassing.propagate" title="torch_geometric.nn.conv.MessagePassing.propagate"><code class="xref py py-meth docutils literal notranslate"><span class="pre">propagate()</span></code></a> is invoked.
It should have the following signature:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">hook</span><span class="p">(</span><span class="n">module</span><span class="p">,</span> <span class="n">inputs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">modified</span> <span class="nb">input</span>
</pre></div>
</div>
<p>The hook can modify the input.
Input keyword arguments are passed to the hook as a dictionary in
<code class="xref py py-obj docutils literal notranslate"><span class="pre">inputs[-1]</span></code>.</p>
<p>Returns a <code class="xref py py-class docutils literal notranslate"><span class="pre">torch.utils.hooks.RemovableHandle</span></code> that can be used
to remove the added hook by calling <code class="xref py py-obj docutils literal notranslate"><span class="pre">handle.remove()</span></code>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="torch_geometric.nn.conv.MessagePassing.register_propagate_forward_hook">
<span class="sig-name descname"><span class="pre">register_propagate_forward_hook</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hook</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.12)"><span class="pre">Callable</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">RemovableHandle</span></span></span><a class="reference internal" href="../_modules/torch_geometric/nn/conv/message_passing.html#MessagePassing.register_propagate_forward_hook"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torch_geometric.nn.conv.MessagePassing.register_propagate_forward_hook" title="Permalink to this definition"></a></dt>
<dd><p>Registers a forward hook on the module.</p>
<p>The hook will be called every time after <a class="reference internal" href="#torch_geometric.nn.conv.MessagePassing.propagate" title="torch_geometric.nn.conv.MessagePassing.propagate"><code class="xref py py-meth docutils literal notranslate"><span class="pre">propagate()</span></code></a> has computed
an output.
It should have the following signature:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">hook</span><span class="p">(</span><span class="n">module</span><span class="p">,</span> <span class="n">inputs</span><span class="p">,</span> <span class="n">output</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">modified</span> <span class="n">output</span>
</pre></div>
</div>
<p>The hook can modify the output.
Input keyword arguments are passed to the hook as a dictionary in
<code class="xref py py-obj docutils literal notranslate"><span class="pre">inputs[-1]</span></code>.</p>
<p>Returns a <code class="xref py py-class docutils literal notranslate"><span class="pre">torch.utils.hooks.RemovableHandle</span></code> that can be used
to remove the added hook by calling <code class="xref py py-obj docutils literal notranslate"><span class="pre">handle.remove()</span></code>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="torch_geometric.nn.conv.MessagePassing.register_message_forward_pre_hook">
<span class="sig-name descname"><span class="pre">register_message_forward_pre_hook</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hook</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.12)"><span class="pre">Callable</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">RemovableHandle</span></span></span><a class="reference internal" href="../_modules/torch_geometric/nn/conv/message_passing.html#MessagePassing.register_message_forward_pre_hook"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torch_geometric.nn.conv.MessagePassing.register_message_forward_pre_hook" title="Permalink to this definition"></a></dt>
<dd><p>Registers a forward pre-hook on the module.
The hook will be called every time before <a class="reference internal" href="#torch_geometric.nn.conv.MessagePassing.message" title="torch_geometric.nn.conv.MessagePassing.message"><code class="xref py py-meth docutils literal notranslate"><span class="pre">message()</span></code></a> is invoked.
See <a class="reference internal" href="#torch_geometric.nn.conv.MessagePassing.register_propagate_forward_pre_hook" title="torch_geometric.nn.conv.MessagePassing.register_propagate_forward_pre_hook"><code class="xref py py-meth docutils literal notranslate"><span class="pre">register_propagate_forward_pre_hook()</span></code></a> for more information.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="torch_geometric.nn.conv.MessagePassing.register_message_forward_hook">
<span class="sig-name descname"><span class="pre">register_message_forward_hook</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hook</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.12)"><span class="pre">Callable</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">RemovableHandle</span></span></span><a class="reference internal" href="../_modules/torch_geometric/nn/conv/message_passing.html#MessagePassing.register_message_forward_hook"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torch_geometric.nn.conv.MessagePassing.register_message_forward_hook" title="Permalink to this definition"></a></dt>
<dd><p>Registers a forward hook on the module.
The hook will be called every time after <a class="reference internal" href="#torch_geometric.nn.conv.MessagePassing.message" title="torch_geometric.nn.conv.MessagePassing.message"><code class="xref py py-meth docutils literal notranslate"><span class="pre">message()</span></code></a> has computed
an output.
See <a class="reference internal" href="#torch_geometric.nn.conv.MessagePassing.register_propagate_forward_hook" title="torch_geometric.nn.conv.MessagePassing.register_propagate_forward_hook"><code class="xref py py-meth docutils literal notranslate"><span class="pre">register_propagate_forward_hook()</span></code></a> for more information.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="torch_geometric.nn.conv.MessagePassing.register_aggregate_forward_pre_hook">
<span class="sig-name descname"><span class="pre">register_aggregate_forward_pre_hook</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hook</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.12)"><span class="pre">Callable</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">RemovableHandle</span></span></span><a class="reference internal" href="../_modules/torch_geometric/nn/conv/message_passing.html#MessagePassing.register_aggregate_forward_pre_hook"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torch_geometric.nn.conv.MessagePassing.register_aggregate_forward_pre_hook" title="Permalink to this definition"></a></dt>
<dd><p>Registers a forward pre-hook on the module.
The hook will be called every time before <a class="reference internal" href="#torch_geometric.nn.conv.MessagePassing.aggregate" title="torch_geometric.nn.conv.MessagePassing.aggregate"><code class="xref py py-meth docutils literal notranslate"><span class="pre">aggregate()</span></code></a> is invoked.
See <a class="reference internal" href="#torch_geometric.nn.conv.MessagePassing.register_propagate_forward_pre_hook" title="torch_geometric.nn.conv.MessagePassing.register_propagate_forward_pre_hook"><code class="xref py py-meth docutils literal notranslate"><span class="pre">register_propagate_forward_pre_hook()</span></code></a> for more information.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="torch_geometric.nn.conv.MessagePassing.register_aggregate_forward_hook">
<span class="sig-name descname"><span class="pre">register_aggregate_forward_hook</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hook</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.12)"><span class="pre">Callable</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">RemovableHandle</span></span></span><a class="reference internal" href="../_modules/torch_geometric/nn/conv/message_passing.html#MessagePassing.register_aggregate_forward_hook"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torch_geometric.nn.conv.MessagePassing.register_aggregate_forward_hook" title="Permalink to this definition"></a></dt>
<dd><p>Registers a forward hook on the module.
The hook will be called every time after <a class="reference internal" href="#torch_geometric.nn.conv.MessagePassing.aggregate" title="torch_geometric.nn.conv.MessagePassing.aggregate"><code class="xref py py-meth docutils literal notranslate"><span class="pre">aggregate()</span></code></a> has computed
an output.
See <a class="reference internal" href="#torch_geometric.nn.conv.MessagePassing.register_propagate_forward_hook" title="torch_geometric.nn.conv.MessagePassing.register_propagate_forward_hook"><code class="xref py py-meth docutils literal notranslate"><span class="pre">register_propagate_forward_hook()</span></code></a> for more information.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="torch_geometric.nn.conv.MessagePassing.register_message_and_aggregate_forward_pre_hook">
<span class="sig-name descname"><span class="pre">register_message_and_aggregate_forward_pre_hook</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hook</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.12)"><span class="pre">Callable</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">RemovableHandle</span></span></span><a class="reference internal" href="../_modules/torch_geometric/nn/conv/message_passing.html#MessagePassing.register_message_and_aggregate_forward_pre_hook"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torch_geometric.nn.conv.MessagePassing.register_message_and_aggregate_forward_pre_hook" title="Permalink to this definition"></a></dt>
<dd><p>Registers a forward pre-hook on the module.
The hook will be called every time before <a class="reference internal" href="#torch_geometric.nn.conv.MessagePassing.message_and_aggregate" title="torch_geometric.nn.conv.MessagePassing.message_and_aggregate"><code class="xref py py-meth docutils literal notranslate"><span class="pre">message_and_aggregate()</span></code></a>
is invoked.
See <a class="reference internal" href="#torch_geometric.nn.conv.MessagePassing.register_propagate_forward_pre_hook" title="torch_geometric.nn.conv.MessagePassing.register_propagate_forward_pre_hook"><code class="xref py py-meth docutils literal notranslate"><span class="pre">register_propagate_forward_pre_hook()</span></code></a> for more information.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="torch_geometric.nn.conv.MessagePassing.register_message_and_aggregate_forward_hook">
<span class="sig-name descname"><span class="pre">register_message_and_aggregate_forward_hook</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hook</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.12)"><span class="pre">Callable</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">RemovableHandle</span></span></span><a class="reference internal" href="../_modules/torch_geometric/nn/conv/message_passing.html#MessagePassing.register_message_and_aggregate_forward_hook"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torch_geometric.nn.conv.MessagePassing.register_message_and_aggregate_forward_hook" title="Permalink to this definition"></a></dt>
<dd><p>Registers a forward hook on the module.
The hook will be called every time after <a class="reference internal" href="#torch_geometric.nn.conv.MessagePassing.message_and_aggregate" title="torch_geometric.nn.conv.MessagePassing.message_and_aggregate"><code class="xref py py-meth docutils literal notranslate"><span class="pre">message_and_aggregate()</span></code></a>
has computed an output.
See <a class="reference internal" href="#torch_geometric.nn.conv.MessagePassing.register_propagate_forward_hook" title="torch_geometric.nn.conv.MessagePassing.register_propagate_forward_hook"><code class="xref py py-meth docutils literal notranslate"><span class="pre">register_propagate_forward_hook()</span></code></a> for more information.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="torch_geometric.nn.conv.MessagePassing.register_edge_update_forward_pre_hook">
<span class="sig-name descname"><span class="pre">register_edge_update_forward_pre_hook</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hook</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.12)"><span class="pre">Callable</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">RemovableHandle</span></span></span><a class="reference internal" href="../_modules/torch_geometric/nn/conv/message_passing.html#MessagePassing.register_edge_update_forward_pre_hook"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torch_geometric.nn.conv.MessagePassing.register_edge_update_forward_pre_hook" title="Permalink to this definition"></a></dt>
<dd><p>Registers a forward pre-hook on the module.
The hook will be called every time before <a class="reference internal" href="#torch_geometric.nn.conv.MessagePassing.edge_update" title="torch_geometric.nn.conv.MessagePassing.edge_update"><code class="xref py py-meth docutils literal notranslate"><span class="pre">edge_update()</span></code></a> is
invoked. See <a class="reference internal" href="#torch_geometric.nn.conv.MessagePassing.register_propagate_forward_pre_hook" title="torch_geometric.nn.conv.MessagePassing.register_propagate_forward_pre_hook"><code class="xref py py-meth docutils literal notranslate"><span class="pre">register_propagate_forward_pre_hook()</span></code></a> for more
information.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="torch_geometric.nn.conv.MessagePassing.register_edge_update_forward_hook">
<span class="sig-name descname"><span class="pre">register_edge_update_forward_hook</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hook</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.12)"><span class="pre">Callable</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">RemovableHandle</span></span></span><a class="reference internal" href="../_modules/torch_geometric/nn/conv/message_passing.html#MessagePassing.register_edge_update_forward_hook"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torch_geometric.nn.conv.MessagePassing.register_edge_update_forward_hook" title="Permalink to this definition"></a></dt>
<dd><p>Registers a forward hook on the module.
The hook will be called every time after <a class="reference internal" href="#torch_geometric.nn.conv.MessagePassing.edge_update" title="torch_geometric.nn.conv.MessagePassing.edge_update"><code class="xref py py-meth docutils literal notranslate"><span class="pre">edge_update()</span></code></a> has
computed an output.
See <a class="reference internal" href="#torch_geometric.nn.conv.MessagePassing.register_propagate_forward_hook" title="torch_geometric.nn.conv.MessagePassing.register_propagate_forward_hook"><code class="xref py py-meth docutils literal notranslate"><span class="pre">register_propagate_forward_hook()</span></code></a> for more information.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="torch_geometric.nn.conv.MessagePassing.jittable">
<span class="sig-name descname"><span class="pre">jittable</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">typing</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.12)"><span class="pre">Optional</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#torch_geometric.nn.conv.MessagePassing" title="torch_geometric.nn.conv.message_passing.MessagePassing"><span class="pre">MessagePassing</span></a></span></span><a class="reference internal" href="../_modules/torch_geometric/nn/conv/message_passing.html#MessagePassing.jittable"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torch_geometric.nn.conv.MessagePassing.jittable" title="Permalink to this definition"></a></dt>
<dd><p>Analyzes the <a class="reference internal" href="#torch_geometric.nn.conv.MessagePassing" title="torch_geometric.nn.conv.MessagePassing"><code class="xref py py-class docutils literal notranslate"><span class="pre">MessagePassing</span></code></a> instance and produces a new
jittable module that can be used in combination with
<code class="xref py py-meth docutils literal notranslate"><span class="pre">torch.jit.script()</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>typing</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a><em>, </em><em>optional</em>) – If given, will generate a concrete instance
with <a class="reference internal" href="#torch_geometric.nn.conv.MessagePassing.forward" title="torch_geometric.nn.conv.MessagePassing.forward"><code class="xref py py-meth docutils literal notranslate"><span class="pre">forward()</span></code></a> types based on <a class="reference external" href="https://docs.python.org/3/library/typing.html#module-typing" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">typing</span></code></a>, <em>e.g.</em>,
<code class="xref py py-obj docutils literal notranslate"><span class="pre">&quot;(Tensor,</span> <span class="pre">Optional[Tensor])</span> <span class="pre">-&gt;</span> <span class="pre">Tensor&quot;</span></code>.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../modules/nn.html" class="btn btn-neutral float-left" title="torch_geometric.nn" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="torch_geometric.nn.conv.SimpleConv.html" class="btn btn-neutral float-right" title="torch_geometric.nn.conv.SimpleConv" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, PyG Team.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>